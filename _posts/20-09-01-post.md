---
title:  "파일정리도우미"
excerpt: "파일명 일괄 변경 프로그램"

categories:
  - project
  - toy
tags:
  - bash
  - shell
last_modified_at: 2020-9-16 T17:30:00-05:00
toc: true
toc_sticky: true
doc-font-size: 10px;
---

---
<span style="color:grey; font-size:12px;">
<center>
형은 업무상 녹음파일이 많은데, 한번에 날짜별로 수정하는 프로그램이 필요하다했다.
검색해서 나오는 프로그램은 딱 원하는 대로 사용하기가 불편했고, 나도 마침 컴퓨터를 구매하고, 하드디스크에 모든 파일들을 한번에 넣으면서 사진들을 년도별로 정리할 필요가 있었기에 파일명을 바꿔주는 프로그램을 만들기로 했다. 파일을 건드리는 라이브러리에대한 진행하기위해, 쉘 스크립트 를 활용해서 파일명을 변경하는 프로그램을 제작하게 됐다.  
</center>

---
<br><br><br>

## 요구사항
- 파일명은 YYMMDD 형식으로, 변경되며 확장자명을 유지한다.
- 중복된 날의 파일이 존재하는경우, _(N)형식으로 변경한다.  
(중복되는 날이 없는경우는 YYMMDD형식을 유지한다.)
- 파일의 작성시간은 "마지막으로 수정된 날짜"를 기준으로 하며, 파일들은 확장자를 구분하지 않는다.  

<br><br>

## 시행착오 Try & Error
### Try 1. 파일명에 공백문자가 존재하는 경우
- 스크립트는 모든 값이 _String_ 이기에 발생한 문제
        - 공백문자가 배열의 구분자로 사용되어, A a.txt, B b.txt를 읽어서 배열에 저장한 경우 "A" "a.txtB" "b.txt"로 접근한다.  
    __파일명이 원하는데로 접근되지 않았다.__  
    
- __solution__  
    파일에 대한 접근을 배열에 넣어 한번에 해결하는 방식이 아닌, 파일명을 확인하면서 진행하는 방식으로 진행했다. 
```console
!bin/bash
```

<br><br>  

### Try 2. 파일의 순서가 맞지 않는 문제
- 스크립트에서 파일을 읽어들이는 순서는 기존의 정렬 순서이기에, 항상 시간순을 보장하지 않았다.      
    - __sol 1. Hash Table__  
    같은 날의 파일을 hash table와 같은 자료구조에 저장해두었다, 날짜별로 모아서 다시 진행하려햇는데, 해당 방식은 스크립트 언어로 구현하기가 힘들었다. 그래서 2Pass 방식으로 접근했다.  
    - __sol 2. 2PASS__  
  1Pass에서는 모든 파일을 YYMMDDhhmmssms형식으로 변경한다. 이후 2Pass에서 원래의도했던 파일명으로 변경한다. 그렇면, 1Pass에서 시간순을 보장하기에, 변경가능하다.

```console
!bin/bash
```
<br><br>

## 개선점  
- 다 작성하고, 실행해보니, 쉘스크립트는 윈도우 파워쉘에서 동작하지 않는다. 평소에 Git을 쉘로 사용하다보니까, bash로 작성하였다. 형도 편하게 쓸수 있도록 GUI나 exe파일로 만드는것도 고려해보자.  
~~형의 컴퓨터에서는 git이 설치되어있지않았지만 외장하드로 내 PC에서 진행했다.~~
- 현재 코드는 폴더 경로를 지정하지 못한다.  
(경로내 공백문자를 처리하는것이 힘들었기에 실행위치에서 작동하게 되어있다.)  
폴더경로를 지정 할 수 있게 수정하자.
- 내 사진 폴더내에서 실행하려 하니, 몇가지 추가하고 싶은 사항이 있다. 
     폴더명을 읽어서, 파일명_폴더명_확장자 형식으로 변경하고 싶다.  
    예를들어, 190307_제주도여행_n.jpg 형식과 같이, 이미 폴더에 정리되어 있는 파일의 경우 더 명시적으로 변경하고 싶다.

<br><br><br>

## 관련된 포스트
- <a href = "{{site.url}}/about"> 다른 프로젝트 보기 </a>